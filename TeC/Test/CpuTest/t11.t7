;教科書p80 SIO送信割り込み
INT2V	EQU	0DEH
SIOD	EQU	02H
SIOC	EQU	03H
	;メインプログラム
START	LD	SP,#0DCH
	LD	G0,#SIOXINT
	ST 	G0,INT2V
	LD	G0,#80H
	OUT	G0,SIOC
	LD	G0,#DATA
	ST	G0,POINTER
	LD	G0,#1
	ST	G0,FLAG
	EI 
LOOP	LD	G0,FLAG
	CMP	G0,#0
	JZ	END
	JMP	LOOP
END	HALT

DATA	DC 	"IKENAGA"
	DC	0
	;SIO送信割り込み処理ルーチン
SIOXINT	PUSH	G0
	PUSH	G1
	LD	G1,POINTER
	LD	G0,0,G1
	CMP	G0,#0
	JZ	OWARI
	OUT	G0,SIOD
	ADD	G1,#1
	ST	G1,POINTER
	JMP	KAERI
OWARI	LD	G0,#00H
	OUT	G0,SIOC
	ST	G0,FLAG
KAERI	POP	G1
	POP	G0
	RETI
	;割り込み処理ルーチンのデータ
POINTER	DS	1
FLAG	DS	1
